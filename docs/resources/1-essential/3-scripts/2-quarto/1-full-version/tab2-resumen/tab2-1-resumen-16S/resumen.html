<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Metagenomic Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../../">
<script src="../../../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../../site_libs/quarto-html/quarto-syntax-highlighting-54c8f25464f32f8783bd446cee98020d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../../site_libs/bootstrap/bootstrap-c27fce070f9e1faf5b65ec12c04f7688.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../../../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../../../../../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../../../../../../site_libs/datatables-binding-0.34.0/datatables.js"></script>
<script src="../../../../../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../../../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../../../../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../../../../../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../../../../../../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="../../../../../../../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link rel="shortcut icon" href="../../../../../1-images/icons/favicon.svg">
<link rel="icon" type="image/x-icon" href="../../../../../1-images/icons/favicon.ico">


<link rel="stylesheet" href="../../../../../../../resources/1-essential/3-scripts/3-css/styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../../../../../index.html">
    <span class="navbar-title"><img class="brand-logo" src="../../../../../../../resources/1-essential/1-images/icons/ipbln.png"> <a class="brand-text" href="https://www.ipb.csic.es/servicios/Bioinformatica/index.html">IPBLN</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab1-metodologia/metodologia.html"> <i class="bi bi-wrench" role="img">
</i> 
<span class="menu-text">Metodología</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab2-resumen/tab2-1-resumen-16S/resumen.html" aria-current="page"> <i class="bi bi-clipboard-data" role="img">
</i> 
<span class="menu-text">Resumen 16S</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-análisis-16s" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-bar-chart" role="img">
</i> 
 <span class="menu-text">Análisis 16S</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-análisis-16s">    
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/0-contexto.html">
 <span class="dropdown-text">➤ Introducción contextual</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/1-revision-inicial.html">
 <span class="dropdown-text">1. Revisión inicial de muestras y metadatos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/2-control-calidad.html">
 <span class="dropdown-text">2. Control de calidad y preprocesamiento</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/3-generacion-asvs.html">
 <span class="dropdown-text">3. Generación de ASVs y tabla de abundancia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/4-taxonomia-filogenia.html">
 <span class="dropdown-text">4. Asignación taxonómica y filogenia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/5-analisis-diferencial.html">
 <span class="dropdown-text">5. Análisis diferencial de abundancia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/6-diversidad-microbiana.html">
 <span class="dropdown-text">6. Diversidad microbiana</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/7-prediccion-funcional.html">
 <span class="dropdown-text">7. Predicción funcional</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../../resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/8-conclusiones.html">
 <span class="dropdown-text">8. Conclusiones y perspectivas</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Metagenomic Report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Contenedor del chat -->
<div id="chat-container">
  <button id="chat-toggle"></button>
  <div id="chat-box">
    <div id="chat-info" class="chat-info">
      <h1>
        Mini Chat RAG (beta)
      </h1>

      <p>
        ¡Hola! Soy <strong>Geni</strong>, el asistente inteligente de <strong>GenoScribe</strong>.  
        Estoy aquí para ayudarte a explorar de forma interactiva el contenido de este informe bioinformático.
      </p>

      <p>
        Cuando me haces una pregunta, primero intento reconocer si coincide con alguno de los patrones o expresiones que conozco.  
        Si encuentro una coincidencia, te responderé directamente con una respuesta predefinida, diseñada para ser rápida, clara e incluso un poco ingeniosa.  
        Si no reconozco el patrón, entonces activo mis herramientas de búsqueda: genero representaciones vectoriales (embeddings) y busco los fragmentos más relevantes entre varios documentos —incluyendo el propio informe, archivos PDF y HTML externos, y sesiones de preguntas y respuestas (QA).  
        A partir de esa información, creo un resumen que intenta ofrecerte una respuesta coherente y útil basada en el contenido existente.
      </p>

      <p>
        Se debe tener en cuenta que este entorno es experimental. No utilizo grandes modelos de lenguaje, por lo que algunas respuestas pueden ser aproximadas o incompletas.  
        El objetivo principal es facilitar una visualización rápida, comprensible y reproducible de la información contenida en los documentos, permitiendo una exploración más dinámica del informe.
      </p>

      <p>
        Actualmente, los resultados pueden variar en precisión, ya que empleo modelos ligeros y locales para asegurar que la aplicación funcione en cualquier entorno sin necesidad de servidores externos.  
        Sin embargo, la estructura del sistema está preparada para mejorar notablemente su rendimiento en el futuro mediante la integración con modelos más avanzados o APIs externas.  
        Para comenzar, simplemente escribe tu pregunta en el campo inferior y deja que yo me encargue del resto. ¡Prometo poner todo mi código en ello!
      </p>
    </div>
    <div id="chat-log"></div>
    <input id="chat-input" type="text" placeholder="Escribe tu pregunta...">
    <button id="chat-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
        <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"></path>
      </svg>
    </button>
  </div>
</div>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  IMPORTACIONES
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Incluir Font Awesome -->
<p><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"></p>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 2: ANÁLISIS | RESUMEN Y VISIÓN GENERAL DEL EXPERIMENTO 16S -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<div class="informe-titulo-tab-unique">
<h1>
Pestaña
</h1>
<h2>
Resumen 16S del experimento
</h2>
</div>
<div class="flecha-abajo">
<p>▼</p>
</div>
<div class="informe-resumen">
<h2>
Resumen
</h2>
<p>
Esta sección ofrece una <strong>visión general integral</strong> del experimento de <strong>metagenómica 16S</strong> analizado, partiendo del <strong>contexto general</strong> y las características de las <strong>muestras analizadas</strong>, para luego abordar las <strong>estadísticas globales de calidad</strong> derivadas del control de las lecturas obtenidas.
</p>
<p>
Inicialmente, se presenta una descripción detallada de las <strong>muestras únicas</strong>, las <strong>categorías principales</strong> (<em>Type</em>) y las <strong>subcategorías</strong> (<em>TypeII</em>), el <strong>número de tandas</strong>, la <strong>tecnología empleada</strong> (<em>Illumina paired-end</em>) y la <strong>longitud media de las lecturas</strong>. Estas métricas permiten comprender el alcance, la diversidad y la estructura del estudio, así como la organización de los datos para posteriores análisis taxonómicos y funcionales.
</p>
<p>
A continuación, se resumen las principales <strong>métricas globales de calidad</strong>, tales como el <strong>total de lecturas</strong>, <strong>porcentaje de GC</strong>, <strong>lecturas duplicadas</strong>, <strong>longitud media</strong> y <strong>porcentaje de lecturas fallidas</strong>, con valores representativos calculados como medianas o medias según corresponda. Estas métricas se muestran tanto en <strong>tarjetas visuales</strong> que facilitan la interpretación rápida como en una <strong>tabla detallada por muestra</strong>, permitiendo identificar variaciones o posibles problemas de calidad.
</p>
<p>
En conjunto, esta sección establece las bases para evaluar la <strong>calidad</strong> y la <strong>representatividad</strong> del conjunto de datos antes de abordar análisis más profundos de diversidad, abundancia y predicción funcional, y prepara al usuario para continuar con la exploración exhaustiva del proceso en la pestaña <strong><a href="../../tab3-analisis/tab3-1-analisis-16S/0-contexto.html" class="normalink">Análisis</a></strong>.
</p>
</div>
<div style="height: 15px; background-color: transparent;">

</div>
<div class="titulo-toc">
<p>Tabla de contenidos de esta sección</p>
</div>
<div class="toc">
<ul>
<li>
<a href="#tab2-seccion1"> 1<span>.</span> Resumen del experimento </a>
<ul>
<li>
<a href="#tab2-seccion1.1"> 1.1. Contexto y diseño experimental </a>
</li>
<li>
<a href="#tab2-seccion1.2"> 1.2. Estadísticas globales de calidad </a>
</li>
</ul>
</li>
</ul>
</div>
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- REDACCIÓN -->
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<div style="height: 25px; background-color: transparent;">

</div>
<div id="tab2-seccion1" class="titulo1">
<p>1<span>.</span> Resumen del experimento</p>
</div>
<p>
Esta sección proporciona una visión general del experimento de <strong>metagenómica 16S</strong>, comenzando con una descripción de las muestras y su organización, seguida del análisis preliminar de la calidad de las lecturas obtenidas. El objetivo es ofrecer una primera evaluación de la estructura del conjunto de datos y de las métricas globales de calidad, fundamentales para garantizar la fiabilidad de los análisis posteriores.
</p>
<p>
En el apartado <strong>1.1. Contexto y diseño experimental</strong> se detallan las características principales del experimento, incluyendo el número de muestras, las <strong>categorías principales (Type)</strong>, las <strong>subcategorías (TypeII)</strong>, el número de tandas y la tecnología de secuenciación utilizada. A continuación, en <strong>1.2. Estadísticas globales de calidad</strong>, se resumen las métricas clave obtenidas tras el control de calidad de las lecturas, presentadas tanto de forma visual mediante <strong>tarjetas de métricas</strong> como con tablas de detalle por muestra.
</p>
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab2-seccion1.1" class="titulo2">
<p>1.1. Contexto y diseño experimental</p>
</div>
<p>
Se presenta un resumen inicial del experimento de <strong>metagenómica 16S</strong> generado mediante tecnología de secuenciación <strong>Illumina</strong> en modo <strong>Lecturas pareadas (paired-end)</strong>. Las lecturas tienen una longitud esperada de <strong>301 pares de bases</strong>, un parámetro clave que influye en la capacidad de mapeo y en la resolución de la diversidad microbiana.
</p>
<p>
Con el fin de ofrecer una visión clara y rápida de los principales parámetros del conjunto de datos, a continuación se presentan, en formato de tarjetas, los indicadores generales más relevantes de las muestras y su distribución según la estructura de metadatos.
</p>
<div class="metric-cards">
<div class="metric-card blue">
<h3>
Archivos FASTQ totales
</h3>
<p>
32
</p>
</div>
<div class="metric-card green">
<h3>
Archivos FASTQ únicos
</h3>
<p>
16
</p>
</div>
<div class="metric-card yellow">
<h3>
Muestras únicas
</h3>
<p>
21
</p>
</div>
<div class="metric-card orange">
<h3>
Categorías principales
</h3>
<p>
6
</p>
</div>
<div class="metric-card red">
<h3>
Subcategorías
</h3>
<p>
21
</p>
</div>
<div class="metric-card pink">
<h3>
Número de tandas
</h3>
<p>
3
</p>
</div>
<div class="metric-card purple">
<h3>
Longitud esperada
</h3>
<p>
301 bp
</p>
</div>
<div class="metric-card cyan">
<h3>
Modo de secuenciación
</h3>
<p>
Lecturas pareadas (paired-end)
</p>
</div>
<div class="metric-card gray">
<h3>
Fecha del reporte
</h3>
<p>
2025-11-26
</p>
</div>
</div>
<p>
El experimento cuenta con <strong>32</strong> archivos FASTQ, que corresponden a <strong>16</strong> muestras únicas si ignoramos la distinción entre lectura 1 y lectura 2 (R1/R2). Por otra parte, según el archivo de metadatos (<code>sample-metadata.tsv</code>), se registran <strong>21</strong> muestras únicas, organizadas según sus <strong>Tipos principales</strong>, <strong>Subtipos</strong> y <strong>Tandas</strong>. Es importante destacar que no siempre existe una correspondencia directa 1:1 entre las muestras listadas en el TSV y los archivos FASTQ: algunas muestras pueden no tener archivos FASTQ generados, y otros FASTQ pueden corresponder a controles o réplicas no incluidos en el TSV.
</p>
<p>
A continuación se muestran los distintos valores detectados en el archivo de metadatos:
</p>
<ul>
<li>
<strong>Tipos principales (Type)</strong> <strong>⇒</strong> Equine, Ovine, Livestock_exc, Equine_c, Ovine_c, Livestock_exc_c
</li>
<li>
<strong>Subtipos (TypeII)</strong> <strong>⇒</strong> Burro_1, Burro_4, Oveja_1, Oveja_4, Control_1, Control_4, Burro_2, Burro_3, Oveja_2, Oveja_3, Control_2, Control_3, Burro_8M_1, Burro_8M_2, Burro_8M_3, Oveja_8M_1, Oveja_8M_2, Oveja_8M_3, control_compost_8M_1, control_compost_8M_2, control_compost_8M_3
</li>
<li>
<strong>Tandas</strong> <strong>⇒</strong> 2, 3, 4
</li>
</ul>
<p>
La tabla completa de metadatos, que incluye la relación entre cada muestra y sus categorías asignadas, puede consultarse en la siguiente ubicación:
</p>
<p><code>/workspace/data/03-EXT-25-Metagenomic/Resultados/Def_16S/sample-metadata.tsv</code></p>
<p>
Y esta, vendría dada por:
</p>
<div class="scroll-y-max-500">
<div class="datatables html-widget html-fill-item" id="htmlwidget-dbfb59d36768cc354b08" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dbfb59d36768cc354b08">{"x":{"filter":"none","vertical":false,"data":[["NGS069-23_16S_29","NGS069-23_16S_30","NGS069-23_16S_31","NGS069-23_16S_32","NGS069-23_16S_35","NGS069-23_16S_36","NGS001-23_16S_41","NGS001-23_16S_42","NGS001-23_16S_43","NGS001-23_16S_44","NGS001-23_16S_47","NGS001-23_16S_48","NGS069-24-16S-1","NGS069-24-16S-2","NGS069-24-16S-3","NGS069-24-16S-4","NGS069-24-16S-5","NGS069-24-16S-6","NGS069-24-16S-7","NGS069-24-16S-8","NGS069-24-16S-9"],["Equine","Equine","Ovine","Ovine","Livestock_exc","Livestock_exc","Equine","Equine","Ovine","Ovine","Livestock_exc","Livestock_exc","Equine_c","Equine_c","Equine_c","Ovine_c","Ovine_c","Ovine_c","Livestock_exc_c","Livestock_exc_c","Livestock_exc_c"],["Burro_1","Burro_4","Oveja_1","Oveja_4","Control_1","Control_4","Burro_2","Burro_3","Oveja_2","Oveja_3","Control_2","Control_3","Burro_8M_1","Burro_8M_2","Burro_8M_3","Oveja_8M_1","Oveja_8M_2","Oveja_8M_3","control_compost_8M_1","control_compost_8M_2","control_compost_8M_3"],[2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4]],"container":"<table class=\"stripe hover compact\">\n  <thead>\n    <tr>\n      <th>SampleID<\/th>\n      <th>Type<\/th>\n      <th>TypeII<\/th>\n      <th>tanda<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"lengthChange":false,"language":{"url":"//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"},"columnDefs":[{"className":"dt-right","targets":3},{"name":"SampleID","targets":0},{"name":"Type","targets":1},{"name":"TypeII","targets":2},{"name":"tanda","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<p style="text-align:center; margin-top: 5px;">
<a href="../../../../../../../resources/2-nextflow-results/1-project-data/03-EXT-25-Metagenomic/Resultados/Def_16S/sample-metadata.tsv" download="sample-metadata.tsv" class="boton-file-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo “sample-metadata.tsv” </a>
</p>
<p>
La convención de nombres utilizada en los archivos <code>.fastq.gz</code> permite identificar de manera inequívoca cada lectura y emparejar correctamente los pares R1/R2 correspondientes a la misma muestra. Generalmente, los nombres de archivo incluyen información del proyecto, identificador de muestra y etiqueta de lectura (R1 o R2), lo que facilita la trazabilidad desde los datos crudos hasta los análisis posteriores. Esta estructura debe mantenerse de forma consistente para evitar emparejamientos incorrectos o pérdidas de muestras durante el flujo de trabajo.
</p>
<p>
Cada archivo <code>.fastq.gz</code> corresponde a un <strong>SampleID</strong> presente en el archivo de metadatos, garantizando la asociación entre la información de secuenciación y las categorías experimentales o de clasificación utilizadas en el estudio. De esta manera, se asegura que todas las muestras están correctamente representadas y etiquetadas para el análisis de diversidad y abundancia microbiana.
</p>
<p>
La fecha de compilación de este resumen es <strong>2025-11-26</strong>. Este dato es relevante para la trazabilidad y la comparación entre análisis, especialmente en caso de repetir el procesamiento con versiones diferentes del pipeline, del genoma de referencia o de la anotación.
</p>
<p>
En conjunto, esta sección proporciona una visión general preliminar del experimento y su organización.
</p>
<p>
A continuación, en la siguiente sección, se presentarán las estadísticas globales de calidad de las muestras, que facilitarán una evaluación más cuantitativa y detallada.
</p>
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab2-seccion1.2" class="titulo2">
<p>1.2. Estadísticas globales de calidad</p>
</div>
<p>
En esta sección se presentan las principales métricas derivadas del control de calidad y alineamiento de las lecturas de metagenómica 16S. Estos indicadores son fundamentales para evaluar la integridad y adecuación de los datos antes de proceder con el análisis de expresión génica.
</p>
<p>
A continuación se muestran, en formato de tarjetas visuales, los valores centrales para el conjunto de muestras de las siguientes métricas clave:
</p>
<ul>
<li>
<strong>Total de lecturas</strong> <strong>⇒</strong> mediana del número total de secuencias obtenidas por muestra, expresada en <code>0.1millones</code>, que indica la profundidad de secuenciación.
</li>
<li>
<strong>GC (%)</strong> <strong>⇒</strong> contenido medio de guanina y citosina en las lecturas, expresado en <code>57.1%</code>, indicador de representatividad de la biblioteca.
</li>
<li>
<strong>Lecturas duplicadas (%)</strong> <strong>⇒</strong> porcentaje promedio de secuencias repetidas, de <code>88.2%</code>, que puede indicar artefactos técnicos o baja complejidad.
</li>
<li>
<strong>Longitud media (bp)</strong> <strong>⇒</strong> longitud promedio de las lecturas, de <code>301 bp</code>, que influye en la capacidad de mapeo y resolución.
</li>
<li>
<strong>Lecturas fallidas (%)</strong> <strong>⇒</strong> proporción promedio de lecturas descartadas por baja calidad durante el preprocesamiento, de <code>38.5%</code>.
</li>
</ul>
<div class="metric-cards">
<div class="metric-card blue">
<h3>
Total de lecturas
</h3>
<p>
0.1 millones
</p>
</div>
<div class="metric-card green">
<h3>
GC (%)
</h3>
<p>
57.1 %
</p>
</div>
<div class="metric-card red">
<h3>
Lecturas duplicadas
</h3>
<p>
88.2 %
</p>
</div>
<div class="metric-card orange">
<h3>
Longitud media
</h3>
<p>
301 bp
</p>
</div>
<div class="metric-card yellow">
<h3>
Lecturas fallidas
</h3>
<p>
38.5 %
</p>
</div>
</div>
<p>
Para complementar estos indicadores globales, se presenta a continuación una tabla detallada con las métricas calculadas por muestra individual, que permite identificar posibles desviaciones o muestras problemáticas que requieran revisión adicional.
</p>
<div class="scroll-y-max-500">
<div class="datatables html-widget html-fill-item" id="htmlwidget-35975d96b019354b3622" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-35975d96b019354b3622">{"x":{"filter":"none","vertical":false,"data":[["NGS001-23_16S_41_S6_L001_R1_001","NGS001-23_16S_41_S6_L001_R2_001","NGS001-23_16S_42_S12_L001_R1_001","NGS001-23_16S_42_S12_L001_R2_001","NGS001-23_16S_43_S18_L001_R1_001","NGS001-23_16S_43_S18_L001_R2_001","NGS001-23_16S_44_S24_L001_R1_001","NGS001-23_16S_44_S24_L001_R2_001","NGS001-23_16S_45_S30_L001_R1_001","NGS001-23_16S_45_S30_L001_R2_001","NGS001-23_16S_46_S36_L001_R1_001","NGS001-23_16S_46_S36_L001_R2_001","NGS001-23_16S_47_S42_L001_R1_001","NGS001-23_16S_47_S42_L001_R2_001","NGS001-23_16S_48_S48_L001_R1_001","NGS001-23_16S_48_S48_L001_R2_001","NGS069-23_16S_29_S42_L001_R1_001","NGS069-23_16S_29_S42_L001_R2_001","NGS069-23_16S_30_S50_L001_R1_001","NGS069-23_16S_30_S50_L001_R2_001","NGS069-23_16S_31_S59_L001_R1_001","NGS069-23_16S_31_S59_L001_R2_001","NGS069-23_16S_32_S68_L001_R1_001","NGS069-23_16S_32_S68_L001_R2_001","NGS069-23_16S_33_S5_L001_R1_001","NGS069-23_16S_33_S5_L001_R2_001","NGS069-23_16S_34_S14_L001_R1_001","NGS069-23_16S_34_S14_L001_R2_001","NGS069-23_16S_35_S23_L001_R1_001","NGS069-23_16S_35_S23_L001_R2_001","NGS069-23_16S_36_S32_L001_R1_001","NGS069-23_16S_36_S32_L001_R2_001"],[109642,109642,110784,110784,96595,96595,106599,106599,110662,110662,97708,97708,107948,107948,107254,107254,40406,40406,50045,50045,66578,66578,81306,81306,71709,71709,75235,75235,77484,77484,94384,94384],[57,56,58,57,57,57,58,57,58,57,58,57,58,57,57,56,58,58,58,57,58,57,58,57,57,56,56,55,58,57,57,56],[301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301],[301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301,301],[90.53,87.97,90.48999999999999,87.97,90.72,87.70999999999999,90.13,87.2,89.98999999999999,87.47,89.88,87.91,90.44,87.91,90.83,87.67,86.16,78.94,85.89,84.09,87.34999999999999,85.48,87.33,85.29000000000001,88.90000000000001,88.06,89.84999999999999,88.81,90.83,89.3,91.14,89.75],[33.33,41.67,33.33,41.67,25,41.67,25,41.67,33.33,33.33,41.67,41.67,33.33,50,25,50,33.33,41.67,33.33,50,33.33,50,25,50,33.33,50,41.67,41.67,33.33,50,25,50],["NGS001-23_16S_41_S6_L001","NGS001-23_16S_41_S6_L001","NGS001-23_16S_42_S12_L001","NGS001-23_16S_42_S12_L001","NGS001-23_16S_43_S18_L001","NGS001-23_16S_43_S18_L001","NGS001-23_16S_44_S24_L001","NGS001-23_16S_44_S24_L001","NGS001-23_16S_45_S30_L001","NGS001-23_16S_45_S30_L001","NGS001-23_16S_46_S36_L001","NGS001-23_16S_46_S36_L001","NGS001-23_16S_47_S42_L001","NGS001-23_16S_47_S42_L001","NGS001-23_16S_48_S48_L001","NGS001-23_16S_48_S48_L001","NGS069-23_16S_29_S42_L001","NGS069-23_16S_29_S42_L001","NGS069-23_16S_30_S50_L001","NGS069-23_16S_30_S50_L001","NGS069-23_16S_31_S59_L001","NGS069-23_16S_31_S59_L001","NGS069-23_16S_32_S68_L001","NGS069-23_16S_32_S68_L001","NGS069-23_16S_33_S5_L001","NGS069-23_16S_33_S5_L001","NGS069-23_16S_34_S14_L001","NGS069-23_16S_34_S14_L001","NGS069-23_16S_35_S23_L001","NGS069-23_16S_35_S23_L001","NGS069-23_16S_36_S32_L001","NGS069-23_16S_36_S32_L001"]],"container":"<table class=\"stripe hover compact\">\n  <thead>\n    <tr>\n      <th>sample<\/th>\n      <th>total_sequences<\/th>\n      <th>percent_gc<\/th>\n      <th>avg_sequence_length<\/th>\n      <th>median_sequence_length<\/th>\n      <th>percent_duplicates<\/th>\n      <th>percent_fails<\/th>\n      <th>clean_sample<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":false,"lengthChange":false,"language":{"url":"//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"},"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"name":"sample","targets":0},{"name":"total_sequences","targets":1},{"name":"percent_gc","targets":2},{"name":"avg_sequence_length","targets":3},{"name":"median_sequence_length","targets":4},{"name":"percent_duplicates","targets":5},{"name":"percent_fails","targets":6},{"name":"clean_sample","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<p style="text-align:center; margin-top: 5px;">
<a href="../../../../../../../resources/1-essential/2-archives/2-tmp/tab2-resumen/tab2-1-resumen-16S/estadisticas_globales_calidad.csv" download="estadisticas_globales_calidad.csv" class="boton-file-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo “estadisticas_globales_calidad.csv” </a>
</p>
<p>
Así, una vez revisados en esta pestaña los aspectos generales del resumen y las estadísticas globales de calidad, se recomienda continuar explorando la pestaña <a href="../../tab3-analisis/tab3-1-analisis-16S/0-contexto.html" class="normalink">Análisis</a>. Allí se ofrece un recorrido detallado y exhaustivo del procesamiento de datos, que permite visualizar paso a paso cada etapa del flujo de trabajo.
</p>
<p>
En la pestaña <a href="../../tab3-analisis/tab3-1-analisis-16S/1-revision-inicial.html#tab3-seccion1" class="normalink">Análisis</a> se incluye desde la revisión inicial de las muestras y metadatos, pasando por el control de calidad individual y conjunto, hasta el alineamiento y la cuantificación de la expresión génica. También se presentan análisis estadísticos avanzados, normalización, control post-normalización, análisis diferencial y análisis funcional y de enriquecimiento, finalizando con conclusiones y perspectivas del estudio.
</p>
<p>
Esta navegación detallada facilita validar la calidad y la robustez del experimento, identificar posibles problemas y comprender mejor los resultados obtenidos en el resumen general.
</p>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  FOOTER
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<footer>
<a href="#" class="arriba"><i class="fa-solid fa-angles-up"></i></a>
</footer>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CARGAR JAVASCRIPT PARA CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Script exclusivo del chat -->
<script type="module" src="../../../../4-javascript/chatbot.js"></script>




<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="../../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>